<div class="container">
    <div class="h6">Emails</div>
    @*If there are emails, list them in a table and show.*@
    @if (((int)EmailsToWrite?.Count()) > 0)
    {
        <ContactableTemplate Items="EmailsToWrite"
                             TItem="EmailToWrite"
                             Context="email"
                             @key="EmailToWrite"
                             OnRowClick="EditAsync">
            <TableHeader>
                <th>Address</th>
                <th>Primary</th>
            </TableHeader>
            <RowTemplate>
                <td>
                    @email.Address
                </td>
                <td>
                    <TelerikCheckBox @bind-Value="email.IsPrimary" Enabled="false" />
                </td>
            </RowTemplate>
        </ContactableTemplate>
    }

    @*If adding or editing email, show the edit form in modal dialog*@
    @if (Adding || Editing)
    {
        <EditForm Model="EmailToWrite">
            <TelerikWindow Visible="DialogVisible"
                           Modal="true">
                <WindowTitle>
                    Email
                </WindowTitle>
                <WindowContent>
                    <div class="container">
                        <div class="form-group row">
                            <label class="form-control-label">Address</label>
                            <TelerikTextBox @bind-Value="@EmailToWrite.Address"
                                            Width="100%"
                                            @ref="EmailAddressControl">
                            </TelerikTextBox>
                        </div>
                        <div class="form-group row">
                            <label>
                                <TelerikCheckBox @bind-Value="@EmailToWrite.IsPrimary"></TelerikCheckBox>
                                <span class="form-control-label">Primary</span>
                            </label>
                        </div>
                        <div>
                            <TelerikButton OnClick="Save"
                                           Icon="check"
                                           ThemeColor="primary"
                                           ButtonType="ButtonType.Button"
                                           title="Save New Email">
                                Ok
                            </TelerikButton>
                            <TelerikButton OnClick="CancelEdit"
                                           ButtonType="ButtonType.Button"
                                           Icon="x"
                                           title="Cancel New Email">
                                Cancel
                            </TelerikButton>
                        </div>
                    </div>
                </WindowContent>
            </TelerikWindow>
        </EditForm>

    }
    <div>
        <TelerikButton OnClick="AddAsync"
                       Icon="plus"
                       ButtonType="ButtonType.Button"
                       Class="button-border-success"
                       title="Add New Email">
            Add Email
        </TelerikButton>
    </div>
</div>